/*! FM HELPER v0.1.0 | Flerex | flerex.blog */
(function(a,b,c){console.log('%cFM Helper by %cFlerex%c.blog','font-family: "Open Sans", Arial, sans-serif; font-size: 1.2em;','font-size: 1.5em; text-transform: uppercase; letter-spacing: -1px; font-weight: 800; color: #0d5ad5;','color: #e42e88; text-transform: none; font-size: 1.2em; font-style: italic;'),console.log('https://flerex.blog');const d='FMHELPER_';a.FLX=a.FLX||{},a.FLX.helper=function(){function h(O){switch(O.body.id){case'phpbb':return'phpBB3';case'modernbb':return'ModernBB';}return O.getElementById('ipbwrapper')?'Invision':O.querySelector('.pun')?'PunBB':O.body.hasAttribute('bgcolor')?'phpBB2':c}function n(){return-1!=M.id}function o(){switch(_userdata.user_level){case 2:return'mod';case 1:return'admin';case 0:return-1==M.id?'guest':'user';}}function p(){return _userdata.avatar.split('"')[1]}function r(O,P){return O=O.getTime(),P=P.getTime(),Math.floor(Math.abs(O-P)/6.048e8)}function s(O,P){if(!localStorage)return!1;const Q=d+O,R=localStorage.getItem(Q);if(!R)return!1;const S=JSON.parse(R),T=new Date(S.cached_at);return r(T,new Date)>=P?(localStorage.removeItem(Q),!1):S.content}function t(O,P){if(!localStorage)return!1;const Q={cached_at:new Date().getTime(),content:P};localStorage.setItem(d+O,JSON.stringify(Q))}function u(O,P){console.log(P);let Q,R=null,S=P.querySelector('.tooltip-title'),T=P.querySelector('.tooltip-subtitle');if(!S)return null;let U=S.querySelector('span[style]');return U&&(U=U.style.color),S.firstElementChild&&(Q=S.firstElementChild.style.color),T&&(R=T.innerHTML.match(/:\s(.*)/)[1]),new K(O,S.textContent,c,P.getElementsByTagName('img')[0].src,R,+P.querySelector('.tooltip-counts').firstChild.firstElementChild.textContent,U)}function v(O){return Array.from(O).map(P=>new L(P.href.match(/\/g(\d+)-/)[1],P.textContent,P.style.color))}function w(O){return O+'?change_version='+'invision'}function x(O){return /^\w+\s*:\s+(?:\[\s\w+\s\]\s*)+/.test(O.textContent)}function y(O){const P=Array.from(O.body.getElementsByTagName('*')).find(x);return P?P.querySelectorAll('a[href^="/g"]'):null}function z(O){const P=Array.from(O.querySelectorAll('#fo_stat div')).find(x);return P?P.querySelectorAll('a[href^="/g"]'):null}function A(...O){const[P,Q]=I(O),R='groups',S=s(R,Q);if(S)return S.forEach(U=>Object.setPrototypeOf(U,L.prototype)),Promise.resolve(S);const T=D(w('/forum')).then(U=>{let V=z(U)||y(U);if(!V.length)return c;const W=v(V);return t(R,W),W});return P&&T.then(U=>{P.call(this,U)}),T}function B(O,...P){const[Q,R]=I(P),S='u'+O,T=s(S,R);if(T)return Object.setPrototypeOf(T,K.prototype),Promise.resolve(T);const U=D('/ajax/index.php',{data:{f:'m',user_id:O}}).then(V=>{let W=u(O,V);return t(S,W),W});return Q&&U.then(V=>{Q.call(this,V)}),U}function C(O){return'?'+Object.keys(O).map(P=>encodeURIComponent(P)+'='+encodeURIComponent(O[P])).join('&')}function D(O,P={}){return P.hasOwnProperty('data')&&(O+=C(P.data)),fetch(O,Object.assign({method:'GET',credentials:'include'},P)).then(Q=>Q.text()).then(Q=>{return new DOMParser().parseFromString(Q,'text/html')})}function E(O){'loading'==b.readyState?b.addEventListener('DOMContentLoaded',O):O()}function G(O){return!!O.querySelector('div.pagination')&&Array.from(O.querySelector('div.pagination').children).filter(P=>{return'A'==P.tagName&&+P.textContent})}function H(O){return O.querySelectorAll('table.ipbtable tbody tr').length-3}function I(O){let P=[!1,4];return 2==O.length?P=O:'integer'==typeof O[0]?P[1]=O[0]:P[0]=O[0],P}class K{constructor(O,P,Q,R,S,T,U){this.id=O,this.username=P,this.level=Q,this.avatar=R,this.rank=S,this.posts=T,this.color=U}getRankAsText(){if(!this.rank)return'';let O=new DOMParser().parseFromString(this.rank,'text/html');return O.body.textContent.trim()}}class L{constructor(O,P,Q){this.id=O,this.name=P,this.color=Q}}const M=new K(_userdata.user_id,_userdata.username,o(),p(),_lang.hasOwnProperty('rank_title')?_lang.rank_title:c,_userdata.user_posts,c),N={isLoggedIn:n,userLevel:o,getGroups:A,getUser:B,slugify:function(O){const P='\xE0\xE1\xE4\xE2\xE8\xE9\xEB\xEA\xEC\xED\xEF\xEE\xF2\xF3\xF6\xF4\xF9\xFA\xFC\xFB\xF1\xE7\xB7/_,:;';O=O.trim().toLowerCase();for(var R=0,S=P.length;R<S;R++)O=O.replace(new RegExp(P.charAt(R),'g'),'aaaaeeeeiiiioooouuuunc------'.charAt(R));return O.replace(/[^a-z0-9 -]/g,'').replace(/\s+/g,'-').replace(/-+/g,'-')},attachScriptToChat:function(O){function P(R,S){'complete'==R.contentDocument.readyState?S():R.addEventListener('load',S)}let Q=b.createElement('script');Q.type='text/javascript',Q.textContent=`;(${O.toString()})();`,E(function(){const R=b.querySelectorAll('object[data^="/chatbox/index.forum"], iframe[src^="/chatbox/index.forum"]');Array.from(R).foreach(S=>{P(S,function(){S.contentDocument.getElementsByTagName('head')[0].appendChild(Q.cloneNode(!0))})})})},getVersion:function(){return h(b)},enableDebugMode:function(){console.warn('%cATTENTION: Debug mode is enabled','color: red; font-weight: bold; font-size: 1.1em;'),console.warn('CSS files are not being cached by browsers');const O='?debug='+ +new Date;b.querySelectorAll('link[rel="stylesheet"]').forEach(P=>{P.setAttribute('href',P.getAttribute('href')+O)})},get:D};return n()&&Object.assign(N,{currentUser:function(O){switch(O){case'id':return M.id;case'username':case'name':return M.username;case'avatar':return p();}throw'Parameter is not supported by getInfo()'},u:M,user:M}),K.prototype.getGroup=function(){return new Promise(O=>{A().then(P=>{this.color===c?B(this.id).then(Q=>{O(P.find(R=>R.color==Q.color))}):O(P.find(Q=>Q.color==this.color))})})},L.prototype.getMemberAmount=function(...O){const[P,Q]=I(O),R='gc'+this.id,S=s(R,Q);if(S)return Promise.resolve(S);const T=D(w(`/g${this.id}-`)).then(U=>{const V=G(U);if(!V.length){const W=H(U);return t(R,W),W}return D(V.pop().href)}).then(U=>{if('number'==typeof U)return U;const V=G(U),W=50*V.length+H(U);return t(R,W),W});return P&&T.then(U=>{P.call(this,U)}),T},N}(),'undefined'==typeof a._&&(a._=FLX.helper),'undefined'==typeof a.H&&(a.H=FLX.helper)})(this,document);